% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/causalsim.R
\name{coefx}
\alias{coefx}
\title{Multiple regression oefficient from a linear DAG}
\usage{
coefx(fmla, dag)
}
\arguments{
\item{fmla}{a linear model formula. The variables
in the formula must be column names of 
\code{dag}.}

\item{dag}{a square matrix defining a linear DAG. The
column names and row names of A must be 
identical.  The non-diagonal entries of 
\code{dag} contain the causal of coefficients
of arrows pointing from the column variable
to the row variable.  The diagonal entries
are standard deviations of the normally
distributed independent component generating
the row variable. A matrix
defines a linear dag if the same permutation
of its rows and columns can transform it into
a lower diagonal matrix.}
}
\value{
a list with class 'coefx' containing 
       the population coefficient for the first
       predictor variable in \code{fmla}, the residual 
       standard error of the regression, the conditional
       standard deviation of the residual of the first
       predictor and the ratio of the last two quantities
       which constitutes the 'standard error factor' which,
       if multiplied by 1/sqrt(n) is an estimate of the
       standard error of the estimate of the regression
       coefficient for the first predictor variable.
}
\description{
Given a linear DAG, find the population regression 
coefficent using data with the marginal covariance
structure implied by the linear DAG.
}
\examples{
nams <- c('zc','zl','zr','c','x','y','m','i')
err <- rep(.2, length(nams))
names(err) <- nams
mat <- matrix(0, length(nams), length(nams))
rownames(mat) <- nams
colnames(mat) <- nams

# confounding back-door path
mat['zl','zc'] <- 2 
mat['zr','zc'] <- 2
mat['x','zl'] <- 1
mat['y','zr'] <- 2

# direct effect
mat['y','x'] <- 3

# indirect effect
mat['m','x'] <- 1
mat['y','m'] <- 1

# Instrumental variable 
mat['x','i'] <- 2

# 'Covariate'
mat['y','c'] <- 1

# independent error
diag(mat) <- 2

mat # not in lower diagonal form   
to_dag(mat) # can be permuted to lower-diagonal form

coefx(y ~ x, mat)  # with confounding
coefx(y ~ x + zc, mat)  # blocking back-door path
coefx(y ~ x + zr, mat) # blocking with lower SE
coefx(y ~ x + zl, mat) # blocking with worse SE
coefx(y ~ x + zr + c, mat)  # adding a 'covariate'
coefx(y ~ x + zr + m, mat)  # including a mediator
coefx(y ~ x + zl + i, mat)  # including an instrument
coefx(y ~ x + zl + i + c, mat) # I and C

# plotting added-variable plot ellipse 
lines(
    coefx(y ~ x + zr, mat),  
    lwd = 2, xv= 5,xlim = c(-5,10), ylim = c(-25, 50))
lines(
    coefx(y ~ x + zl, mat), new = F,
    col = 'red', xv = 5, lwd = 2)
lines(
    coefx(y ~ x + i, mat), new = F,
    col = 'dark green', xv = 5)
}
